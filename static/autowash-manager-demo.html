<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoWash Network Manager Demo - GitHub Style</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            margin: 0;
            padding: 20px;
            background: #f6f8fa;
            color: #24292f;
        }
        
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12);
            overflow: hidden;
        }
        
        .demo-header {
            background: #24292f;
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .demo-header h1 {
            margin: 0;
            font-size: 24px;
            font-weight: 600;
        }
        
        .demo-header p {
            margin: 10px 0 0;
            opacity: 0.8;
        }
        
        .demo-section {
            padding: 30px;
            border-bottom: 1px solid #d0d7de;
        }
        
        .demo-section:last-child {
            border-bottom: none;
        }
        
        .demo-section h2 {
            margin: 0 0 20px;
            color: #24292f;
            font-size: 20px;
            font-weight: 600;
        }
        
        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .demo-card {
            background: #f6f8fa;
            border: 1px solid #d0d7de;
            border-radius: 6px;
            padding: 16px;
        }
        
        .demo-card h3 {
            margin: 0 0 12px;
            font-size: 16px;
            font-weight: 600;
        }
        
        .demo-card p {
            margin: 0 0 16px;
            color: #656d76;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .btn {
            background: #2da44e;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s;
            margin-right: 8px;
            margin-bottom: 8px;
        }
        
        .btn:hover {
            background: #2c974b;
        }
        
        .btn-secondary {
            background: #f6f8fa;
            color: #24292f;
            border: 1px solid #d0d7de;
        }
        
        .btn-secondary:hover {
            background: #f3f4f6;
        }
        
        .btn-danger {
            background: #da3633;
        }
        
        .btn-danger:hover {
            background: #c93c37;
        }
        
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-online {
            background: #dafbe1;
            color: #1f8729;
        }
        
        .status-offline {
            background: #ffebe9;
            color: #d1242f;
        }
        
        .status-loading {
            background: #fff8c5;
            color: #744500;
        }
        
        .code-block {
            background: #f6f8fa;
            border: 1px solid #d0d7de;
            border-radius: 6px;
            padding: 16px;
            font-family: 'SF Mono', Monaco, Inconsolata, 'Roboto Mono', monospace;
            font-size: 12px;
            overflow-x: auto;
            margin: 16px 0;
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
        }
        
        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid #d0d7de;
            display: flex;
            align-items: center;
        }
        
        .feature-list li:last-child {
            border-bottom: none;
        }
        
        .feature-list li::before {
            content: '‚úì';
            color: #2da44e;
            font-weight: bold;
            margin-right: 12px;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1>üöÄ AutoWash Network Manager</h1>
            <p>GitHub-level network management with unified loading states</p>
            <div class="status-indicator status-online" id="connection-status">
                <span id="status-dot">‚óè</span>
                <span id="status-text">Online</span>
            </div>
        </div>

        <div class="demo-section">
            <h2>üåê Network State Management</h2>
            <p>GitHub-style connection monitoring with automatic retry and offline queuing</p>
            
            <div class="demo-grid">
                <div class="demo-card">
                    <h3>Connection Monitoring</h3>
                    <p>Real-time network status detection with visual feedback</p>
                    <button class="btn btn-secondary" onclick="simulateOffline()">Simulate Offline</button>
                    <button class="btn btn-secondary" onclick="simulateOnline()">Simulate Online</button>
                </div>
                
                <div class="demo-card">
                    <h3>Request Interception</h3>
                    <p>Automatic handling of fetch() and AJAX requests with timeout protection</p>
                    <button class="btn" onclick="testNetworkRequest()">Test Network Request</button>
                    <button class="btn btn-danger" onclick="testFailedRequest()">Test Failed Request</button>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h2>‚≠ï Loading Circle System</h2>
            <p>Unified loading states that track real browser loading, not just JavaScript events</p>
            
            <div class="demo-grid">
                <div class="demo-card">
                    <h3>Global Loading Overlay</h3>
                    <p>GitHub-style loading with backdrop blur and smooth animations</p>
                    <button class="btn" onclick="showGlobalLoading()">Show Global Loading</button>
                    <button class="btn btn-secondary" onclick="hideGlobalLoading()">Hide Loading</button>
                </div>
                
                <div class="demo-card">
                    <h3>Form Loading States</h3>
                    <p>Automatic form loading indicators with duplicate submission prevention</p>
                    <form id="demo-form" onsubmit="handleFormSubmit(event)">
                        <button type="submit" class="btn">Submit Form (Demo)</button>
                    </form>
                </div>
                
                <div class="demo-card">
                    <h3>Custom Loading Messages</h3>
                    <p>Dynamic loading text that reflects current operation</p>
                    <button class="btn" onclick="showCustomLoading('Saving changes...')">Saving</button>
                    <button class="btn" onclick="showCustomLoading('Processing payment...')">Processing</button>
                    <button class="btn" onclick="showCustomLoading('Uploading files...')">Uploading</button>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h2>üîÑ GitHub-Level Features</h2>
            <p>Enterprise-grade features inspired by GitHub's robust architecture</p>
            
            <div class="demo-grid">
                <div class="demo-card">
                    <h3>Health Monitoring</h3>
                    <p>Continuous background health checks with performance monitoring</p>
                    <ul class="feature-list">
                        <li>30-second interval health checks</li>
                        <li>Response time monitoring</li>
                        <li>Slow connection detection</li>
                        <li>Automatic error reporting</li>
                    </ul>
                </div>
                
                <div class="demo-card">
                    <h3>Request Management</h3>
                    <p>Sophisticated request handling with retry logic</p>
                    <ul class="feature-list">
                        <li>Duplicate request prevention</li>
                        <li>Request queuing for offline mode</li>
                        <li>Automatic retry with exponential backoff</li>
                        <li>Timeout protection</li>
                    </ul>
                </div>
                
                <div class="demo-card">
                    <h3>Performance Optimization</h3>
                    <p>Intelligent caching and resource management</p>
                    <ul class="feature-list">
                        <li>Legacy system cleanup</li>
                        <li>Memory leak prevention</li>
                        <li>Mobile-optimized animations</li>
                        <li>Efficient event handling</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h2>üìã System Status</h2>
            <div id="system-status">
                <div class="code-block" id="status-display">
                    Loading system status...
                </div>
            </div>
            <button class="btn btn-secondary" onclick="refreshStatus()">Refresh Status</button>
        </div>

        <div class="demo-section">
            <h2>üõ†Ô∏è Usage Examples</h2>
            <p>How to use the AutoWash Manager in your code:</p>
            
            <div class="code-block">
// Show global loading with custom message
window.AutoWash.setGlobalLoading(true, 'Processing your request...');

// Hide loading
window.AutoWash.setGlobalLoading(false);

// Show connection status message
window.AutoWash.showMessage('Operation completed successfully', 'success');

// Get current system status
const status = window.AutoWash.getStatus();
console.log(status); // { online: true, loading: false, activeRequests: 0, queuedRequests: 0 }

// The system automatically handles:
// - Form submissions (prevents duplicates, shows loading states)
// - Network requests (retry logic, timeout protection)
// - Page navigation (smooth loading transitions)
// - Offline scenarios (request queuing, user feedback)
            </div>
        </div>
    </div>

    <!-- Include the AutoWash Manager -->
    <script src="/static/js/autowash-manager.js"></script>
    
    <script>
        // Demo functions
        function simulateOffline() {
            // Simulate offline event
            window.dispatchEvent(new Event('offline'));
            updateConnectionStatus(false);
        }
        
        function simulateOnline() {
            // Simulate online event
            window.dispatchEvent(new Event('online'));
            updateConnectionStatus(true);
        }
        
        function updateConnectionStatus(isOnline) {
            const statusElement = document.getElementById('connection-status');
            const dotElement = document.getElementById('status-dot');
            const textElement = document.getElementById('status-text');
            
            if (isOnline) {
                statusElement.className = 'status-indicator status-online';
                textElement.textContent = 'Online';
            } else {
                statusElement.className = 'status-indicator status-offline';
                textElement.textContent = 'Offline';
            }
        }
        
        function testNetworkRequest() {
            showMessage('Testing network request...', 'info');
            
            fetch('/api/health/')
                .then(response => response.json())
                .then(data => {
                    showMessage(`Request successful! Response time: ${data.response_time_ms}ms`, 'success');
                })
                .catch(error => {
                    showMessage(`Request failed: ${error.message}`, 'error');
                });
        }
        
        function testFailedRequest() {
            showMessage('Testing failed request...', 'info');
            
            fetch('/non-existent-endpoint')
                .then(response => {
                    if (!response.ok) throw new Error(`HTTP ${response.status}`);
                    return response.json();
                })
                .catch(error => {
                    showMessage(`Expected failure: ${error.message}`, 'warning');
                });
        }
        
        function showGlobalLoading() {
            if (window.AutoWash) {
                window.AutoWash.setGlobalLoading(true, 'Demo loading state...');
                
                // Auto-hide after 3 seconds
                setTimeout(() => {
                    window.AutoWash.setGlobalLoading(false);
                }, 3000);
            }
        }
        
        function hideGlobalLoading() {
            if (window.AutoWash) {
                window.AutoWash.setGlobalLoading(false);
            }
        }
        
        function showCustomLoading(message) {
            if (window.AutoWash) {
                window.AutoWash.setGlobalLoading(true, message);
                
                // Auto-hide after 2 seconds
                setTimeout(() => {
                    window.AutoWash.setGlobalLoading(false);
                }, 2000);
            }
        }
        
        function handleFormSubmit(event) {
            event.preventDefault();
            showMessage('Form submitted! (Demo - no actual submission)', 'success');
            return false;
        }
        
        function showMessage(message, type = 'info') {
            if (window.AutoWash) {
                window.AutoWash.showMessage(message, type);
            } else {
                alert(message);
            }
        }
        
        function refreshStatus() {
            const statusDisplay = document.getElementById('status-display');
            
            if (window.AutoWash) {
                const status = window.AutoWash.getStatus();
                statusDisplay.textContent = JSON.stringify({
                    ...status,
                    timestamp: new Date().toISOString(),
                    userAgent: navigator.userAgent.substring(0, 50) + '...',
                    connectionType: navigator.connection ? navigator.connection.effectiveType : 'unknown',
                    onLine: navigator.onLine
                }, null, 2);
            } else {
                statusDisplay.textContent = 'AutoWash Manager not loaded yet...';
            }
        }
        
        // Initialize demo when AutoWash Manager is ready
        document.addEventListener('DOMContentLoaded', function() {
            // Wait for AutoWash Manager to initialize
            setTimeout(() => {
                refreshStatus();
                
                // Update status every 5 seconds
                setInterval(refreshStatus, 5000);
            }, 1000);
        });
        
        // Monitor network events
        window.addEventListener('online', () => updateConnectionStatus(true));
        window.addEventListener('offline', () => updateConnectionStatus(false));
    </script>
</body>
</html>